[section#flat.map.overview
    [:en] Overview
    [:zh_CN] 概要
]

[%@lib flat_map]
[para]
[:en] A [`flat_map] is a container adaptor that provides an associative container
interface that supports unique keys (i.e., contains at most one of each key
value) and provides for fast retrieval of values of another type [`T] based on
the keys.
[:zh_CN] [`flat_map] 是一种提供关联容器的接口的容器适配器，支持唯一键（即包含
每个键值的最多一个元素），并提供基于键的对另一个类型 [`T] 的值的快速检索。

[:en] [`flat_map] supports iterators that meet the [^:oc InputIterator]
requirements and model the [`:c random_access_iterator] concept
([#iterator.concept.random.access]).
[:zh_CN] [`flat_map] 支持的迭代器满足 [^:oc InputIterator] 的规定，并构成
[`:c random_access_iterator] 概念（[#iterator.concept.random.access]）。

[para]
[:en] A [`flat_map] meets all of the requirements of a container
([#container.reqmts]) and of a reversible container ([#container.rev.reqmts]),
plus the optional container requirements ([#container.opt.reqmts]).
[:zh_CN] [`flat_map] 满足容器（[#container.reqmts]）和可反向容器
（[#container.rev.reqmts]）的所有规定，加上可选的容器规定（[#container.opt.reqmts]）。

[:en] [`flat_map] meets the requirements of an associative container
([#associative.reqmts]), except that:
[:en] [`flat_map] 满足关联容器的规定（[#associative.reqmts]），但：

[list]
[item]
[:en] it does not meet the requirements related to node handles ([#container.node]),
[:zh_CN] 它不满足与节点句柄有关的规定（[#container.node]），
[item]
[:en] it does not meet the requirements related to iterator invalidation, and
[:zh_CN] 它不满足与迭代器失效有关的规定，并且
[item]
[:en] the time complexity of the operations that insert or erase a single
element from the map is linear, including the ones that take an insertion
position iterator.
[:zh_CN] 从映射中插入或擦除单个元素的操作（包括接受插入位置迭代器的操作）的时间
复杂度是线性的。
[list:end]

[begin:note]
[:en] A [`flat_map] does not meet the additional requirements of an
allocator-aware container ([#container.alloc.reqmts]).
[:zh_CN] [`flat_map] 不满足迭代器感知容器的额外规定（[#container.alloc.reqmts]）。
[end:note]

[para]
[:en] A [`flat_map] also provides most operations described in
[#associative.reqmts] for unique keys.
[:zh_CN] [`flat_map] 还提供 [#associative.reqmts] 所描述的大多数唯一键的操作。

[:en] This means that a [`flat_map] supports the [`a_uniq] operations in
[#associative.reqmts] but not the [`a_eq] operations.
[:zh_CN] 这意味着 [`flat_map] 支持 [#associative.reqmts] 中的 [`a_uniq] 的操作，
但不支持 [`a_eq] 的操作。

[:en] For a [`flat_map<Key, T>] the [`key_type] is [`Key] and the [`value_type]
is [`pair<const Key, T>].
[:zh_CN] [`flat_map<Key, T>] 的 [`key_type] 为 [`Key]，而其 [`value_type] 为
[`pair<const Key, T>]。

[para]
[:en] Descriptions are provided here only for operations on [`flat_map] that are
not described in one of those sets of requirements or for operations where there
is additional semantic information.
[:zh_CN] 此处给出的说明仅包括未被这些规定的集合之一所描述的 [`flat_map] 的操作，
以及具有额外的语义信息的操作。

[para]
[:en] A [`flat_map] maintains the following invariants:
[:zh_CN] [`flat_map] 维持以下不变式：
[list]
[item]
[:en] it contains the same number of keys and values;
[:zh_CN] 它包含相同数量的键和值；
[item]
[:en] the keys are sorted with respect to the comparison object; and
[:zh_CN] 这些键根据比较对象有序；并且
[item]
[:en] the value at offset [`off] within the value container is the value
associated with the key at offset [`off] within the key container.
[:zh_CN] 值容器中偏移 [`off] 处的值是与键容器中偏移 [`off] 处的键相关联的值。
[list:end]

[para]
[:en] If any member function in [#flat.map.defn] exits via an exception
the invariants are restored.
[:zh_CN] 如果 [#flat.map.defn] 中的任何成员函数以异常退出，则恢复其不变式。

[begin:note]
[:en] This can result in the [`flat_map] being emptied.
[:zh_CN] 这会导致 [`flat_map] 被清空。
[end:note]

[para]
[:en] Any sequence container ([#sequence.reqmts]) [`C] supporting
[^:oc RandomAccessIterator] can be used to instantiate [`flat_map], as long as
invocations of member functions [`C::size] and [`C::max_size] do not exit via an
exception.
[:zh_CN] 任何支持 [^:oc RandomAccessIterator]（[#sequence.reqmts]）的序列容器
[`C] 均可用于创建 [`flat_map] 实例，只要其成员函数 [`C::size] 和 [`C::max_size]
不会以异常退出。

[:en] In particular, [`vector] ([#vector]) and [`deque] ([#deque]) can be used.
[:zh_CN] 特别是，可以使用 [`vector]（[#vector]）和 [`deque]（[#deque]）。

[begin:note]
[:en] [`vector<bool>] is not a sequence container.
[:zh_CN] [`vector<bool>] 不是序列容器。
[end:note]

[para]
[:en] The program is ill-formed if [`Key] is not the same type as
[`KeyContainer::value_type] or [`T] is not the same type as
[`MappedContainer::value_type].
[:zh_CN] 如果 [`Key] 与 [`KeyContainer::value_type] 不是相同类型，或者 [`T] 与
[`MappedContainer::value_type] 不是相同类型，则程序非良构。

[para]
[:en] The effect of calling a constructor that takes both [`key_container_type]
and [`mapped_container_type] arguments with containers of different sizes is
undefined.
[:zh_CN] 以不同大小的容器调用同时接受 [`key_container_type] 和
[`mapped_container_type] 实参的构造函数的效果是未定义的。

[para]
[:en] The effect of calling a constructor or member function that takes a
[`sorted_unique_t] argument with a container, containers, or range that is not
sorted with respect to [`key_comp()], or that contains equal elements, is
undefined.
[:zh_CN] 以并未根据 [`key_comp()] 有序或者包含相等元素的容器或范围，调用接受
[`sorted_unique_t] 的构造函数或成员函数的效果是未定义的。
