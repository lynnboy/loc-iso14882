[section#ratio.reflection.array
    [:en] Promoting to static storage arrays
    [:zh_CN] 提升为静态存储数组
]

[para]
[:en] The functions in this subclause promote compile-time storage into static storage.
[:zh_CN] 本子条款中的各函数将编译时存储提升为静态存储。

[%@lib reflect_constant_string]
[codeblock:declaration]
template<ranges::[[redoc("`:c>")]]input_range R>
  consteval info reflect_constant_string(R&& r);
[codeblock:end]

[div:description]
[para]
[:en] Let [`CharT] be [`ranges::range_value_t<R>].
[:zh_CN] 令 [`CharT] 为 [`ranges::range_value_t<R>]。

[para:mandates]
[:en] [`CharT] is one of [`char], [`wchar_t], [`char8_t], [`char16_t], [`char32_t].
[:zh_CN] [`CharT] 为 [`char]、[`wchar_t]、[`char8_t]、[`char16_t] 或 [`char32_t] 之一。

[para]
[:en] Let [$V] be the pack of values of type [`CharT] whose elements are the
corresponding elements of [`r], except that if [`r] refers to a string literal object,
then [$V] does not include the trailing null terminator of [`r].
[:zh_CN] 令 [$V] 为 [`CharT] 类型的值的包组，其各元素为 [`r] 的对应元素，但当
[`r] 指代字符串字面量对象时，[$V] 不包含 [`r] 的尾部空终结符。

[para]
[:en] Let [$P] be the template parameter object ([#temp.param])
of type [`const CharT`[sizeof...(V) + 1`]] initialized with [`{[$V]..., CharT()}].
[:zh_CN] 令 [$P] 为以 [`{[$V]..., CharT()}] 初始化的
[`const CharT`[sizeof...(V) + 1`]] 类型的模板形参对象（[#temp.param]）。

[para:returns]
[:en] [`^^[$P]].
[:zh_CN] [`^^[$P]]。

[para]
[begin:note]
[:en] [$P] is a potentially non-unique object ([#intro.object]).
[:zh_CN] [$P] 是潜在非独有对象（[#intro.object]）。
[end:note]
[div:end]

[%@lib reflect_constant_array]
[codeblock:declaration]
template<ranges::[[redoc("`:c>")]]input_range R>
  consteval info reflect_constant_array(R&& r);
[codeblock:end]

[div:description]
[para]
[:en] Let [`T] be [`ranges::range_value_t<R>].
[:zh_CN] 令 [`T] 为 [`ranges::range_value_t<R>]。

[para:mandates]
[:en] [`T] is a structural type ([#temp.param]),
[`is_constructible_v<T, ranges::range_reference_t<R>>] is [`true], and
[`is_copy_constructible_v<T>] is [`true].
[:zh_CN] [`T] 是结构化类型（[#temp.param]），
[`is_constructible_v<T, ranges::range_reference_t<R>>] 为 [`true]，并且
[`is_copy_constructible_v<T>] 为 [`true]。

[para]
[:en] Let [$V] be the pack of values of type [`info] of the same size as [`r],
where the [$i^\text{th}] element is [`reflect_constant([$[`e]_i])],
where [$[`e]_i] is the [$i^\text{th}] element of [`r].
[:zh_CN] 令 [$V] 为大小与 [`r] 相同的 [`info] 类型的值的包组，其中第 [$i] 个元素
为 [`reflect_constant([$[`e]_i])]，其中 [$[`e]_i] 为 [`r] 的第 [$i] 个元素。

[para]
[:en] Let [$P] be
[:zh_CN] 令 [$P] 为：
[list]
[item]
[:en] If [`sizeof...([$V]) > 0] is true, then the template parameter object ([#temp.param])
of type [`const T`[sizeof...([$V])`]] initialized with [`{`[:[$V]:`]...}].
[:zh_CN] 如果 [`sizeof...([$V]) > 0] 为 [`true]，则为以 [`{`[:[$V]:`]...}]
初始化的 [`const T`[sizeof...([$V])`]] 类型的模板形参对象（[#temp.param]）。
[item]
[:en] Otherwise, the template parameter object of type [`array<T, 0>] initialized with [`{}].
[:zh_CN] 否则，为以 [`{}] 初始化的 [`array<T, 0>] 类型的模板形参对象。
[list:end]

[para:returns]
[:en] [`^^[$P]].
[:zh_CN] [`^^[$P]]。

[para:throws]
[:en] [`meta::exception] unless [`reflect_constant(e)] is a constant subexpression
for every element [`e] of [`r].
[:zh_CN] 除非 [`reflect_constant(e)] 对于 [`r] 的每个元素 [`e] 都是常量子表达式，
否则抛出 [`meta::exception]。

[para]
[begin:note]
[:en] [$P] is a potentially non-unique object ([#intro.object]).
[:zh_CN] [$P] 是潜在非独有对象（[#intro.object]）。
[end:note]
[div:end]
